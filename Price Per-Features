


# In[28]:


import pandas as pd
import numpy as np


# In[29]:


file_path = r'C:\Users\MarketCipher\Downloads\HackathonDataSet\PrimaryDataset-MLS-RentalProperties.csv'
df = pd.read_csv(file_path)


# In[30]:


df.head()


# In[31]:


# Create a new dataframe with calculated columns
df_price_metrics = pd.DataFrame()

# Assuming 'List Price', 'Bedrooms Total', 'Bathrooms Full', 'Bathrooms Total', 'Stories', 'Garage Spaces', 'Living Area', 'Lot Size Acres', 'Year Built' columns exist in your dataset

df_price_metrics['Price per Bedroom'] = df['List Price'] / df['Bedrooms Total']
df_price_metrics['Price per Full Bathroom'] = df['List Price'] / df['Bathrooms Full']
df_price_metrics['Price per Total Bathroom'] = df['List Price'] / df['Bathrooms Total']
df_price_metrics['Price per Story'] = df['List Price'] / df['Stories']
df_price_metrics['Price per Garage Space'] = df['List Price'] / df['Garage Spaces']
df_price_metrics['Price per Living Area'] = df['List Price'] / df['Living Area']
df_price_metrics['Price per Lot Size Acre'] = df['List Price'] / df['Lot Size Acres']
df_price_metrics['Price per Year Built'] = df['List Price'] / df['Year Built']

# Display the first few rows of the new dataframe
df_price_metrics.head()


# In[32]:


df_price_metrics['Price per Story'].fillna(df['List Price'], inplace=True)


# In[33]:


# Handle Garage Spaces: Instead of 0, fill NaN with the median value
df_price_metrics['Price per Garage Space'].fillna(df_price_metrics['Price per Garage Space'].median(), inplace=True)


# In[34]:


# Replace infinity for Price per Acre with the median value
df_price_metrics['Price per Lot Size Acre'].replace([np.inf, -np.inf], np.nan, inplace=True)
df_price_metrics['Price per Lot Size Acre'].fillna(df_price_metrics['Price per Lot Size Acre'].median(), inplace=True)


# In[35]:


df_price_metrics.fillna(df_price_metrics.median(), inplace=True)


# In[36]:


df_price_metrics.head()


# In[37]:


df_price_metrics

